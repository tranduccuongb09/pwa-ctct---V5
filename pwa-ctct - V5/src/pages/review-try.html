<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Xem l·∫°i & gi·∫£i th√≠ch | Thi th·ª≠</title>
  <link rel="stylesheet" href="style.css"><!-- s·ª≠a ƒë∆∞·ªùng d·∫´n ƒë√∫ng v·ªõi d·ª± √°n -->
  <style>
    :root{
      --brand:#991b1b;
      --bg:#f7f8fa;
      --card:#fff;
      --ring:#e6e7ea;
      --muted:#6b7280;
      --ok:#065f46;
      --bad:#991b1b;
      --skip:#475569;
      --radius:14px;
      --shadow:0 1px 2px rgba(0,0,0,.05);
      --font: clamp(15px, 1.6vw, 17px); /* tƒÉng c·ª° ch·ªØ nh∆∞ng KH√îNG ƒë·ªïi font-family */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
    /* KH√îNG ƒë·∫∑t font-family ·ªü ƒë√¢y ƒë·ªÉ k·∫ø th·ª´a Roboto t·ª´ CSS chung */
    font-size: clamp(15px, 1.6vw, 17px);
    line-height: 1.65;
    font-weight: 500;
    color:#111827;
    }
    .container{max-width:1024px;margin:0 auto;padding:0 16px}
    header{
      background:var(--brand); color:#fff;
      position:sticky; top:0; z-index:10;
      box-shadow:0 1px 0 rgba(0,0,0,.08);
    }
    .topbar{display:flex; align-items:center; gap:10px; height:56px}
    .back{
      display:inline-flex; align-items:center; gap:8px;
      color:#fff; text-decoration:none; font-weight:700;
      padding:8px 10px; border-radius:10px;
    }
    .back:hover{background:rgba(255,255,255,.12)}
    main{padding:18px 0 24px}
    .card{
      background:var(--card); border:1px solid var(--ring);
      border-radius:var(--radius); box-shadow:var(--shadow);
    }
    .section{padding:16px}
    .review-pills{display:flex;flex-wrap:wrap;gap:.6rem}
    .pill{
      display:inline-flex; align-items:center; gap:.5rem;
      padding:.38rem .7rem; border-radius:999px;
      background:#f3f4f6; font-weight:700;
    }
    .qwrap{margin-top:12px}
    .qitem{padding:14px 16px;border-top:1px solid var(--ring)}
    .qitem:first-child{border-top:0}
    .q{font-weight:800; font-size:1.05rem; margin:0 0 6px}
    .ans{margin:2px 0 0}
    .exp{color:var(--muted); margin-top:8px}
    .ok .ans{color:var(--ok)}
    .bad .ans{color:var(--bad)}
    .skip .ans{color:var(--skip)}
    .actions{
      margin-top:16px;
      display:grid; grid-template-columns: repeat(4, 1fr);
      gap:10px;
    }
    @media (max-width:720px){
      .actions{grid-template-columns: 1fr 1fr}
    }
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      height:44px; padding:0 14px; border-radius:12px;
      border:1px solid var(--ring); background:#fff;
      text-decoration:none; color:#111827; font-weight:800;
      box-shadow:var(--shadow);
    }
    .btn.primary{background:var(--brand); border-color:var(--brand); color:#fff}
    .btn:hover{filter:brightness(.98)}
  </style>
</head>
<body>
  <header>
    <div class="container topbar">
      <a id="homeLink" class="back" href="index.html" title="V·ªÅ Trang ch·ªß">‚Üê Trang ch·ªß</a>
      <div style="font-weight:800">XEM L·∫†I &amp; GI·∫¢I TH√çCH</div>
    </div>
  </header>

  <main class="container">
    <div class="card section">
      <div id="reviewMeta" class="review-pills"></div>
    </div>

    <div class="card qwrap">
      <div id="reviewList"></div>
      <div class="section">
        <div class="actions">
          <a id="redoBtn" class="btn" href="try.html">‚Üª L√†m l·∫°i</a>
          <!-- t√¨m n√∫t -->
            <a id="resultsBtn" class="btn" href="try-results.html">üìä K·∫øt qu·∫£ c·ªßa t√¥i</a>
          <a id="materialsBtn" class="btn" href="materials.html">üìö T√†i li·ªáu h·ªçc t·∫≠p</a>
          <a id="homeBtn" class="btn primary" href="index.html">üè† V·ªÅ Trang ch·ªß</a>
        </div>
      </div>
    </div>
  </main>

  <script>
    (function(){
      const HOME_HREF = 'index.html';
      const MATERIALS_FALLBACK = 'materials.html';

      document.getElementById('homeLink').setAttribute('href', HOME_HREF);
      document.getElementById('homeBtn').setAttribute('href', HOME_HREF);

      const LS_KEY = 'ctct_try_last_result';
      const pack = JSON.parse(localStorage.getItem(LS_KEY)||'{}');

      const pills = document.getElementById('reviewMeta');
      const list  = document.getElementById('reviewList');

      if (!pack || !Array.isArray(pack.details)) {
        document.querySelector('main').innerHTML =
          '<div class="card section"><b>Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ xem l·∫°i.</b><br/>B·∫°n h√£y ho√†n th√†nh m·ªôt b√†i thi th·ª≠, sau ƒë√≥ b·∫•m ‚ÄúXem l·∫°i &amp; gi·∫£i th√≠ch‚Äù.</div>';
        return;
      }

      const name  = pack.name || '-';
      const unit  = pack.unit || '';
      const pos   = pack.position || '';
      const topic = pack.topicLabel || pack.topic || '';
      const code  = pack.examCode || '';
      const score = Number(pack.score||0);
      const total = Number(pack.total||0);

      const pillItems = [
        `üë§ ${name}`,
        unit ? `üè¢ ${unit}` : '',
        pos  ? `üéñÔ∏è ${pos}` : '',
        topic? `üéØ ${topic}` : '',
        code ? `üßæ M√£ ƒë·ªÅ: ${code}` : '',
        `üìà ƒêi·ªÉm: ${score}/${total}`
      ].filter(Boolean);
      pills.innerHTML = pillItems.map(t=>`<span class="pill">${t}</span>`).join('');

      list.innerHTML = pack.details.map(d=>{
        const chosen  = (d.chosen||'').trim();
        const correct = (d.correct||'').trim();
        const answered= !!chosen;
        const ok      = answered && chosen===correct;

        let cls = 'skip', line = `‚Äî <b>Kh√¥ng tr·∫£ l·ªùi</b> ‚Ä¢ ƒê√∫ng: <b>${correct}</b>`;
        if (answered) {
          if (ok) { cls='ok';  line = `‚úîÔ∏è <b>ƒê√∫ng</b> ‚Äî B·∫°n ch·ªçn: <b>${chosen}</b> ‚Ä¢ ƒê√∫ng: <b>${correct}</b>`; }
          else    { cls='bad'; line = `‚úñÔ∏è <b>Sai</b> ‚Äî B·∫°n ch·ªçn: <b>${chosen}</b> ‚Ä¢ ƒê√∫ng: <b>${correct}</b>`; }
        }

        const exp = d.explanation ? `<div class="exp"><b>Gi·∫£i th√≠ch:</b> ${d.explanation}</div>` : '';
        return `<div class="qitem ${cls}">
                  <div class="q">C√¢u ${d.index}. ${d.question||''}</div>
                  <div class="ans">${line}</div>
                  ${exp}
                </div>`;
      }).join('');

      const materialsBtn = document.getElementById('materialsBtn');
      if (materialsBtn && (!materialsBtn.getAttribute('href') || materialsBtn.getAttribute('href')==='#')) {
        materialsBtn.setAttribute('href', MATERIALS_FALLBACK);
      }
    })();
  </script>
</body>
</html>
