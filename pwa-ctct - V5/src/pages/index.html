<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BAN CH·ªà HUY PTKV3 ‚Äì Trung t√¢m Gi√°o d·ª•c Ch√≠nh tr·ªã s·ªë</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.webmanifest">

  <!-- CSS l√µi -->
  <link rel="stylesheet" href="../css/style.css?v=20251006">
  <link rel="stylesheet" href="../css/nav.css?v=20251006">
  <link rel="stylesheet" href="../css/home.css?v=20251006">
  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;800&display=swap" rel="stylesheet" />

  <style>
    :root{
      --brand-gold:#FFD966;
      --card-bg:rgba(255,255,255,.08);
      --card-stroke:rgba(255,255,255,.18);
      --blur:12px;
    }

    /* ===== N·ªÄN C·ªê ƒê·ªäNH ===== */
    .bg-layer{
      position:fixed; inset:0; z-index:-1; pointer-events:none;
      background-image:
        linear-gradient(180deg, rgba(139,22,22,.78) 0%, rgba(164,25,25,.82) 60%, rgba(185,62,30,.70) 85%, rgba(255,217,102,.30) 100%),
        var(--bg-desktop, url("/assets/bg-desktop.png"));
      background-size:cover,cover; background-position:center,center; background-repeat:no-repeat,no-repeat;
    }
    @media (max-width:768px){
      .bg-layer{
        background-image:
          linear-gradient(180deg, rgba(164,25,25,.84), rgba(139,22,22,.84)),
          var(--bg-mobile, url("/assets/bg-mobile.png"));
      }
    }

    /* ===== Typo + Layout ===== */
    body.home, body.home *:not(code):not(kbd){
      font-family:"Be Vietnam Pro",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif!important;
    }
    body{color:#fff}
    .container{max-width:1180px;margin:0 auto;padding:0 20px}

    /* ===== HERO ===== */
    .hero {position: relative; color: #fff;}
    
    @media (max-width: 900px){.hero__inner { grid-template-columns: 1fr; padding-top: 72px; }}

    .hero p{max-width: 820px; font-size: clamp(16px, 2.2vw, 20px); opacity: .98; margin-bottom: 28px;}
    .hero__actions{ display:flex; gap:14px; flex-wrap:wrap; }
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px; padding: 14px 26px;border-radius: 14px; font-weight: 800;font-size: 18px; cursor:pointer; user-select:none; text-decoration:none; transition: transform .08s ease, box-shadow .25s ease, background .25s ease, color .25s ease, border-color .25s ease;}
    .btn--primary{background:#FFD966; color:#7E120F; border:0; box-shadow: 0 8px 24px rgba(255,217,102,.35);}
    .btn--primary:hover{background:#FFE680; transform: translateY(-1px); box-shadow: 0 10px 28px rgba(255,217,102,.48);}
    .btn--ghost{background: transparent; color:#FFD966; border:2px solid #FFD966; box-shadow: 0 6px 20px rgba(255,217,102,.18);}
    .btn--ghost:hover{ background:#FFD966; color:#7E120F; transform: translateY(-1px); }
    .hero-badge{display:inline-flex;align-items:center;gap:8px; padding:8px 14px;border-radius:999px; font-weight:700; color:#FFD966; background:rgba(255,217,102,.14); border:1px solid rgba(255,217,102,.35); backdrop-filter: blur(2px); margin-bottom: 10px;}
    
      /* ===== KPI (s·ªë li·ªáu th·∫≠t) ===== */
    .strip{padding:18px 0 6px}
    .kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
    .kpi{background:var(--card-bg);border:1px solid var(--card-stroke);border-radius:14px;padding:16px 14px;backdrop-filter:blur(var(--blur));text-align:center}
    .kpi strong{display:block;font-size:28px}
    .kpi span{opacity:.9}

    /* ===== L∆∞·ªõi t√≠nh nƒÉng ===== */
    .features{padding:28px 0 10px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .card{background:var(--card-bg);border:1px solid var(--card-stroke);border-radius:16px;padding:18px;backdrop-filter:blur(var(--blur));}
    .card h3{margin:0 0 6px;font-size:18px}
    .card p{margin:0;opacity:.92}
    .ic{width:32px;height:32px;display:inline-flex;align-items:center;justify-content:center;margin-right:8px}

    /* ===== Footer chuy√™n nghi·ªáp ===== */
    .pro-footer{margin-top: 24px; color:#f7f7f7;}
    .pro-footer .f-wave{display:block; width:100%; height:70px;}
    .pro-footer .f-panel{background: rgba(0,0,0,.16); border-top: 1px solid rgba(255,255,255,.12); backdrop-filter: blur(4px); padding: 18px 0 8px;}
    .pro-footer .f-grid{display:grid; grid-template-columns: 1.2fr 1fr 1fr; gap: 22px; align-items:flex-start; padding: 8px 0 16px;}
    @media (max-width:900px){.pro-footer .f-grid{ grid-template-columns:1fr; gap:10px; }}

    .pro-footer h4{ margin:0 0 8px; font-size:16px; color:#FFD966; }
    .pro-footer p{ margin:6px 0; color:#f1f1f1; opacity:.95; }
    .pro-footer a{ color:#FFE680; text-decoration:none; }
    .pro-footer a:hover{ text-decoration:underline; }
    .pro-footer .legal{ border-top:1px dashed rgba(255,255,255,.18); margin-top:8px; padding-top:10px; font-size:14px; text-align:center; color:#EDE0A0;}
    /* ===== NAV auth (ƒë·∫πp ‚Äì g·ªçn) ===== */
    .nav__search .search__input{
      border-radius: 999px;
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.18);
      color: #fff; padding: 10px 14px;
    }
    .nav__search .search__btn{
      border-radius: 999px;
      background: #FFD966; color:#111;
      font-weight:700; padding:10px 14px;
    }
    .btn-auth{
      border-radius:999px; background:rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.18);
      color:#fff; padding:8px 14px; font-weight:700;
      transition:.2s; backdrop-filter:blur(8px);
    }
    .btn-auth:hover{ background:rgba(255,255,255,.18); }
    .btn-auth--primary{
      background:linear-gradient(180deg,#FFE68A,#FFD04D);
      color:#111; border:none; box-shadow:0 6px 20px rgba(0,0,0,.18);
    }
    .btn-auth--primary:hover{ filter:brightness(1.03); }

    .m-auth .m-btn{ width:100%; border-radius:12px; padding:10px 12px;
      border:1px solid rgba(255,255,255,.2); background:rgba(255,255,255,.06);
      color:#fff; font-weight:700; }
    .m-auth .m-btn--primary{ background:linear-gradient(180deg,#FFE68A,#FFD04D); color:#111; border:none; }

    /* ===== Responsive ===== */
    @media(max-width:940px){
      .hero__inner{grid-template-columns:1fr}
      .grid{grid-template-columns:1fr 1fr}
      .kpis{grid-template-columns:1fr 1fr}
      .pro-footer .f-grid{grid-template-columns:1fr 1fr}
    }
    @media(max-width:640px){
      .grid{grid-template-columns:1fr}
      .pro-footer .f-grid{grid-template-columns:1fr}
    }
    .hero-media{ display: none !important; }

  </style>

  <!-- D√≤ ƒë∆∞·ªùng d·∫´n ·∫£nh n·ªÅn (ch·∫°y ·ªü m·ªçi m√¥i tr∆∞·ªùng) -->
  <script>
    (function(){
      const bust = Date.now();
      const desk = ["/assets/bg-desktop.png","../../public/assets/bg-desktop.png","../assets/bg-desktop.png","./assets/bg-desktop.png"];
      const mob  = ["/assets/bg-mobile.png","../../public/assets/bg-mobile.png","../assets/bg-mobile.png","./assets/bg-mobile.png"];
      function pick(paths, cb){ let i=0; const step=()=>{ if(i>=paths.length) return cb(null);
        const u=paths[i++]+ "?v="+bust; const im=new Image(); im.onload=()=>cb(u); im.onerror=step; im.src=u; }; step(); }
      window.addEventListener('DOMContentLoaded',()=>{
        pick(desk,(u)=>{ if(u) document.documentElement.style.setProperty('--bg-desktop', `url("${u}")`); });
        pick(mob, (u)=>{ if(u) document.documentElement.style.setProperty('--bg-mobile',  `url("${u}")`); });
      });
    })();
  </script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      addEventListener('load', () => { navigator.serviceWorker.register('/sw.js').catch(()=>{}); });
    }
  </script>
</head>

<body class="home" data-page="home">
  <!-- N·ªÄN -->
  <div class="bg-layer" aria-hidden="true"></div>

  <!-- NAVBAR -->
  <header class="nav nav-dark">
    <div class="nav__inner container">
      <a class="brand" href="index.html">B·ªò CHQS T·ªàNH B·∫ÆC NINH</a>

      <button class="nav__toggle" aria-label="M·ªü menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>

      <nav class="nav__links">
        <a href="index.html" class="is-active">Trang ch·ªß</a>
        <a href="materials.html">T√†i li·ªáu h·ªçc t·∫≠p</a>
        <div class="nav__item has-dropdown">
          <a href="exam.html">L√†m b√†i ki·ªÉm tra ‚ñæ</a>
          <div class="dropdown">
            <a href="exam.html">Ki·ªÉm tra nh·∫≠n th·ª©c</a>
            <a href="practice.html">√în tr·∫Øc nghi·ªám</a>
            <a href="quiz.html">Thi th·ª≠</a>
          </div>
        </div>
        <div class="nav__item has-dropdown">
          <a href="results.html">K·∫øt qu·∫£ ki·ªÉm tra ‚ñæ</a>
          <div class="dropdown">
            <a href="my-results.html">K·∫øt qu·∫£ c·ªßa t√¥i</a>
            <a href="leaderboard.html">B·∫£ng x·∫øp h·∫°ng</a>
          </div>
        </div>
      </nav>

      <!-- Search -->
      <form id="globalSearch" class="nav__search hide-sm" role="search" aria-label="T√¨m ki·∫øm">
        <input class="search__input" type="search" name="q" placeholder="T√¨m t√†i li·ªáu, ch·ªß ƒë·ªÅ‚Ä¶" autocomplete="off">
        <button class="search__btn" type="submit">T√¨m ki·∫øm</button>
      </form>

      <!-- Auth actions (desktop) -->
       <div id="userChip" class="user-chip" hidden></div>
        <div class="nav__actions hide-sm">
        <button id="btnLogin"  class="btn btn-auth btn-auth--primary" type="button">ƒêƒÉng k√Ω / ƒêƒÉng nh·∫≠p</button>
        <button id="btnLogout" class="btn btn-auth" type="button" hidden>ƒêƒÉng xu·∫•t</button>
        <span id="navProfile" class="brand" hidden></span>
      </div>
    </div>
  </header>

  <!-- MOBILE DRAWER -->
  <aside id="mDrawer" class="m-drawer" aria-hidden="true">
    <div class="m-head">
      <span class="m-home" aria-label="Trang ch·ªß" title="Trang ch·ªß">üè†</span>
      <span class="m-brand">B·ªò CHQS T·ªàNH B·∫ÆC NINH</span>
    </div>

    <nav class="m-menu" role="navigation">
      <a class="m-item" href="index.html">Trang ch·ªß</a>
      <a class="m-item" href="materials.html">T√†i li·ªáu h·ªçc t·∫≠p</a>

      <button class="m-item m-drop" data-target="#m-exam">L√†m b√†i ki·ªÉm tra <span class="caret">‚ñæ</span></button>
      <div id="m-exam" class="m-sub">
        <a href="exam.html">Ki·ªÉm tra nh·∫≠n th·ª©c</a>
        <a href="practice.html">√în tr·∫Øc nghi·ªám</a>
        <a href="quiz.html">Thi th·ª≠</a>
      </div>

      <button class="m-item m-drop" data-target="#m-result">K·∫øt qu·∫£ ki·ªÉm tra <span class="caret">‚ñæ</span></button>
      <div id="m-result" class="m-sub">
        <a href="my-results.html">K·∫øt qu·∫£ c·ªßa t√¥i</a>
        <a href="leaderboard.html">B·∫£ng x·∫øp h·∫°ng</a>
      </div>

      <a class="m-item" href="#" id="m-ai">Tr·ª£ l√Ω AI</a>

      <!-- Auth mobile -->
      <div class="m-auth">
        <button type="button" class="m-btn m-btn--primary" id="m-login">ƒêƒÉng k√Ω / ƒêƒÉng nh·∫≠p</button>
        <button type="button" class="m-btn m-ghost" id="m-register" hidden>ƒêƒÉng xu·∫•t</button>
      </div>
    </nav>
  </aside>

  <!-- HERO -->
  <section class="hero">
    <div class="container hero__inner">
      <div>
        <div class="hero-badge">üéñÔ∏è Trung t√¢m Gi√°o d·ª•c Ch√≠nh tr·ªã s·ªë</div>
        <h1 class="soft-gold-v3">BAN CH·ªà HUY PTKV3</h1>
        <p>Kho t√†i li·ªáu ƒëa ph∆∞∆°ng ti·ªán ¬∑ Tr·ª£ l√Ω AI h·ªèi ƒë√°p t·ª©c th√¨ ¬∑ B√†i ki·ªÉm tra & ph√¢n t√≠ch k·∫øt qu·∫£ theo chu·∫©n.</p>
        <div class="hero__actions">
          <a href="materials.html" class="btn btn--primary">B·∫Øt ƒë·∫ßu h·ªçc t·∫≠p</a>
          <button id="ai-toggle" type="button" class="btn btn--ghost hide-sm">Tr·ª£ l√Ω AI</button>
        </div>
      </div>
      
    </div>
  </section>

  <!-- KPI TH·ª∞C -->
  <section class="strip">
    <div class="container kpis">
      <div class="kpi"><strong id="kpiSessions">0</strong><span>L∆∞·ª£t h·ªçc/th√°ng</span></div>
      <div class="kpi"><strong id="kpiCompletion">0%</strong><span>T·ª∑ l·ªá ho√†n th√†nh b√†i</span></div>
      <div class="kpi"><strong id="kpiStartTime">0 ph√∫t</strong><span>Th·ªùi gian b·∫Øt ƒë·∫ßu</span></div>
      <div class="kpi"><strong id="kpiAi24">0</strong><span>Phi√™n h·ªèi ƒë√°p AI</span></div>
    </div>
  </section>

  <!-- L∆Ø·ªöI T√çNH NƒÇNG -->
  <section class="features">
    <div class="container grid">
      <div class="card"><h3><span class="ic">üìö</span>T√†i li·ªáu h·ªçc t·∫≠p</h3><p>T√†i li·ªáu chu·∫©n h√≥a, ph√¢n theo ch·ªß ƒë·ªÅ. T√¨m ki·∫øm nhanh.</p></div>
      <div class="card"><h3><span class="ic">üß†</span>√în t·∫≠p & Thi th·ª≠</h3><p>Ng√¢n h√†ng c√¢u h·ªèi b√°m s√°t chu·∫©n. Luy·ªán thi c√≥ th·ªùi gian.</p></div>
      <div class="card"><h3><span class="ic">üìä</span>Ph√¢n t√≠ch k·∫øt qu·∫£</h3><p>Th·ªëng k√™ ƒëi·ªÉm, nh·∫≠n di·ªán ƒëi·ªÉm y·∫øu, g·ª£i √Ω l·ªô tr√¨nh.</p></div>
      <div class="card"><h3><span class="ic">ü§ñ</span>Tr·ª£ l√Ω AI</h3><p>H·ªèi ‚Äì ƒë√°p t·ª©c th√¨, tr√≠ch ngu·ªìn r√µ r√†ng.</p></div>
      <div class="card"><h3><span class="ic">üõ°Ô∏è</span>B·∫£o m·∫≠t & Minh b·∫°ch</h3><p>ƒêƒÉng nh·∫≠p an to√†n, l∆∞u v·∫øt b√†i l√†m.</p></div>
      <div class="card"><h3><span class="ic">üì±</span>Th√¢n thi·ªán ƒëa thi·∫øt b·ªã</h3><p>Tr·∫£i nghi·ªám th·ªëng nh·∫•t tr√™n di ƒë·ªông & desktop.</p></div>
    </div>
  </section>

  <!-- FOOTER CHUY√äN NGHI·ªÜP -->
  <footer class="pro-footer">
    <svg class="f-wave" viewBox="0 0 1440 70" preserveAspectRatio="none" aria-hidden="true">
      <path d="M0,40 C240,10 480,10 720,40 C960,70 1200,70 1440,40 L1440,70 L0,70 Z"
            fill="rgba(255,255,255,.14)"></path>
    </svg>

    <div class="f-panel">
      <div class="container f-grid">
        <div>
          <h4>B·ªò CHQS T·ªàNH B·∫ÆC NINH</h4>
          <p>Trung t√¢m Gi√°o d·ª•c Ch√≠nh tr·ªã s·ªë ‚Äì ¬© 2025</p>
          <p>Ph√°t tri·ªÉn b·ªüi PTKV3 Digital Team</p>
        </div>
        <div>
          <h4>Li√™n k·∫øt</h4>
          <p><a href="materials.html">T√†i li·ªáu h·ªçc t·∫≠p</a></p>
          <p><a href="exam.html">B√†i ki·ªÉm tra</a></p>
          <p><a href="leaderboard.html">B·∫£ng x·∫øp h·∫°ng</a></p>
        </div>
        <div>
          <h4>H·ªó tr·ª£</h4>
          <p><a href="practice.html">√în tr·∫Øc nghi·ªám</a></p>
          <p><a href="quiz.html">Thi th·ª≠</a></p>
          <p><a href="#" id="m-ai">Tr·ª£ l√Ω AI</a></p>
        </div>
      </div>
    </div>
  </footer>

  <!-- AI tray (gi·ªØ nguy√™n hook) -->
  <div id="ai-tray" class="ai-tray" hidden>
    <div class="ai-tray__panel">
      <header class="ai-tray__head">
        <strong>Tr·ª£ l√Ω AI</strong>
        <div class="ai-head-actions">
          <button id="ai-minify" class="ai-head-btn" title="Thu nh·ªè">‚Äì</button>
          <button id="ai-close"  class="ai-head-btn" title="ƒê√≥ng">‚úï</button>
        </div>
      </header>
      <div id="ai-messages" class="ai-tray__messages"></div>
      <div id="ai-previews" class="ai-previews" hidden></div>
      <form id="ai-form" class="ai-tray__form">
        <input id="ai-input" type="text" placeholder="Nh·∫≠p c√¢u h·ªèi‚Ä¶" autocomplete="off"/>
        <button type="submit">G·ª≠i</button>
      </form>
    </div>
  </div>
  <button id="ai-dock" class="ai-fab" hidden>Tr·ª£ l√Ω AI</button>

  <!-- JS c≈© -->
  <script src="../js/config.js" defer></script>
  <script src="../js/net.js" defer></script>
  <script src="../js/analytics.js" defer></script>
  <script src="../js/navbar.js" defer></script>
  <script src="../js/search.js" defer></script>
  <script src="../js/news.js" defer></script>
  <script src="../js/ai.js" defer></script>
  <script src="../js/app.js" defer></script>

  <!-- KPI th·ª±c: analytics.js (window.PTKV3_STATS) + fallback localStorage -->
  <script>
    (function(){
      function n(v){ try{ return Number(v)||0 }catch{return 0} }
      function fmt(x){ try{ return Number(x).toLocaleString('vi-VN') }catch{return x} }
      function pct(r){ return (Math.round((r||0)*1000)/10)+'%' }

      const s = (window.PTKV3_STATS||{});
      let sessions = n(s.sessions30d);
      let attempts  = n(s.attempts30d);
      let completed = n(s.completedAttempts30d);
      let startMin  = n(s.avgStartMinutes);
      let aiCount   = n(s.aiSessions30d);

      try{
        const THIRTY = 30*24*60*60*1000, now = Date.now();

        if(!sessions){
          const arr = JSON.parse(localStorage.getItem('ctct_learning_sessions')||'[]');
          sessions = Array.isArray(arr) ? arr.filter(ts => now-n(ts) < THIRTY).length : 0;
        }
        if(!attempts || !completed){
          const arr = JSON.parse(localStorage.getItem('ctct_results')||'[]');
          const recent = Array.isArray(arr) ? arr.filter(r => now-n(r?.ts) < THIRTY) : [];
          attempts  = attempts  || recent.length;
          completed = completed || recent.filter(r => !!r?.finished).length;
        }
        if(!aiCount){
          const arr = JSON.parse(localStorage.getItem('ctct_ai_sessions')||'[]');
          aiCount = Array.isArray(arr) ? arr.filter(ts => now-n(ts) < THIRTY).length : 0;
        }
        if(!startMin){
          startMin = n(localStorage.getItem('ctct_avg_start_minutes'));
        }
      }catch(e){}

      document.getElementById('kpiSessions').textContent   = fmt(sessions);
      document.getElementById('kpiCompletion').textContent = pct(attempts? completed/attempts : 0);
      document.getElementById('kpiStartTime').textContent  = (startMin||0) + ' ph√∫t';
      document.getElementById('kpiAi24').textContent       = fmt(aiCount);
      document.getElementById('y').textContent = new Date().getFullYear();
    })();
  </script>

  <!-- √âp UI Auth: ch·ªâ 1 n√∫t ƒêK/ƒêN ho·∫∑c ƒêƒÉng xu·∫•t -->
  <script>
    (function () {
      const btnLogin   = document.getElementById('btnLogin');
      const btnLogout  = document.getElementById('btnLogout');
      const mLogin     = document.getElementById('m-login');
      const mLogout    = document.getElementById('m-register'); // d√πng l√†m ƒêƒÉng xu·∫•t (gi·ªØ hook)

      const goLogin = () => { location.href = 'login.html'; };
      btnLogin?.addEventListener('click', goLogin);
      mLogin?.addEventListener('click', goLogin);

      function isAuthed() {
        try {
          const u = window.CTCT_USER;
          if (u && (u.isLoggedIn || u.id || u.token)) return true;
          const t = localStorage.getItem('ctct_token') || sessionStorage.getItem('ctct_token');
          return !!t && t !== 'null' && t !== 'undefined';
        } catch { return false; }
      }

      function updateAuthUI() {
        const authed = isAuthed();
        if (authed) {
          if (btnLogin)  btnLogin.style.display  = 'none';
          if (btnLogout) btnLogout.style.display = 'inline-block';
          if (mLogin)    mLogin.style.display    = 'none';
          if (mLogout)   mLogout.style.display   = 'inline-block';
        } else {
          if (btnLogin)  btnLogin.style.display  = 'inline-block';
          if (btnLogout) btnLogout.style.display = 'none';
          if (mLogin)    mLogin.style.display    = 'inline-block';
          if (mLogout)   mLogout.style.display   = 'none';
        }
      }

      function doLogout() {
        try {
          localStorage.removeItem('ctct_token');
          sessionStorage.removeItem('ctct_token');
          if (window.CTCT_USER) delete window.CTCT_USER;
        } catch {}
        updateAuthUI();
      }

      btnLogout?.addEventListener('click', doLogout);
      mLogout?.addEventListener('click', doLogout);

      updateAuthUI();
      window.addEventListener('storage', (e) => { if (e.key === 'ctct_token') updateAuthUI(); });
      window.addEventListener('ctct:auth-changed', updateAuthUI);
    })();
  </script>
  <script>
  (function(){
    const y = document.getElementById('y');
    if (y) y.textContent = new Date().getFullYear();
  })();
</script>
</body>
</html>
